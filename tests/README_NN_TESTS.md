# KotML Neural Network Tests

Этот документ описывает comprehensive тесты для классов FFN и Sequential в библиотеке KotML.

## Структура тестов

### test_ffn.cpp
Comprehensive тесты для класса FFN (Feed-Forward Network):

#### Основные группы тестов:
- **Construction**: Тестирование создания FFN с различными параметрами
- **ForwardPass**: Проверка прямого прохода через сеть
- **Parameters**: Управление параметрами и их подсчет
- **TrainingMode**: Переключение между режимами обучения и вывода
- **Compilation**: Тестирование компиляции с оптимизаторами и функциями потерь
- **Prediction**: Проверка метода Predict()
- **Training**: Полное тестирование процесса обучения
- **RegressionTraining**: Специализированные тесты для регрессии
- **ClassificationTraining**: Специализированные тесты для классификации
- **BatchTraining**: Тестирование различных размеров батчей
- **ArchitectureInfo**: Проверка информации об архитектуре
- **NetworkInfo**: Тестирование методов получения информации о сети
- **LargeNetwork**: Тесты производительности на больших сетях
- **EdgeCases**: Граничные случаи и обработка ошибок

### test_sequential.cpp
Comprehensive тесты для класса Sequential:

#### Основные группы тестов:
- **BuilderPattern**: Тестирование паттерна строителя
- **MoveSemantics**: Проверка семантики перемещения
- **BuilderValidation**: Валидация безопасности строителя
- **LayerTypes**: Тестирование всех типов слоев
- **ForwardPass**: Проверка прямого прохода
- **Parameters**: Управление параметрами
- **TrainingMode**: Режимы обучения и вывода
- **Compilation**: Компиляция сети
- **Prediction**: Метод Predict()
- **Training**: Полное обучение
- **RegressionTraining**: Регрессионные задачи
- **ClassificationTraining**: Классификационные задачи
- **BatchTraining**: Батчевое обучение
- **DropoutBehavior**: Специальное поведение Dropout
- **ComplexArchitecture**: Тесты сложных архитектур
- **LayerAccess**: Доступ к отдельным слоям
- **NetworkInfo**: Информация о сети
- **ValidationTraining**: Обучение с валидационными данными
- **CustomModule**: Добавление пользовательских модулей
- **EdgeCases**: Граничные случаи

### test_ffn_vs_sequential.cpp
Сравнительные тесты между FFN и Sequential:

#### Основные группы тестов:
- **EquivalentArchitectures**: Сравнение эквивалентных архитектур
- **ParameterEquivalence**: Эквивалентность параметров
- **TrainingCompatibility**: Совместимость в обучении
- **FFNLimitations**: Ограничения FFN
- **SequentialUniqueFeatures**: Уникальные возможности Sequential
- **ArchitecturalFlexibility**: Гибкость архитектуры
- **PerformanceCharacteristics**: Характеристики производительности
- **APIDesignDifferences**: Различия в дизайне API
- **InformationCapabilities**: Возможности получения информации
- **UseCaseGuidelines**: Руководство по использованию

## Проверяемые методы

### FFN класс:
- ✅ **Construction** - все конструкторы
- ✅ **Compile()** - компиляция с оптимизатором и функцией потерь
- ✅ **Train()** - полное обучение с различными параметрами
- ✅ **Predict()** - предсказания на новых данных
- ✅ **Forward()** - прямой проход
- ✅ **Parameters()** - доступ к параметрам
- ✅ **CountParameters()** - подсчет параметров
- ✅ **SetTraining()/IsTraining()** - режимы работы
- ✅ **ZeroGrad()** - обнуление градиентов
- ✅ **GetInputSize()/GetOutputSize()** - размеры
- ✅ **GetNumLayers()** - количество слоев
- ✅ **GetLayer()** - доступ к слоям
- ✅ **PrintArchitecture()** - вывод архитектуры
- ✅ **IsCompiled()** - статус компиляции
- ✅ **GetOptimizer()/GetLossFunction()** - компоненты обучения

### Sequential класс:
- ✅ **Builder Pattern** - все методы строителя
- ✅ **Linear()/ReLU()/Sigmoid()/Tanh()** - добавление слоев
- ✅ **Dropout()** - слой регуляризации
- ✅ **Input()/Output()** - специальные слои
- ✅ **Add()** - добавление пользовательских модулей
- ✅ **Build()** - финализация построения
- ✅ **IsBuilt()** - статус построения
- ✅ **Compile()** - компиляция
- ✅ **Train()** - обучение
- ✅ **Predict()** - предсказания
- ✅ **Forward()** - прямой проход
- ✅ **Parameters()** - параметры
- ✅ **CountParameters()** - подсчет параметров
- ✅ **SetTraining()/IsTraining()** - режимы
- ✅ **ZeroGrad()** - обнуление градиентов
- ✅ **GetNumLayers()** - количество слоев
- ✅ **GetLayer()** - доступ к слоям
- ✅ **Summary()** - сводка архитектуры
- ✅ **IsCompiled()** - статус компиляции
- ✅ **GetOptimizer()/GetLossFunction()** - компоненты

## Тестовые данные

### Классификация (AND gate):
```cpp
Inputs:  [0,0] -> 0, [0,1] -> 0, [1,0] -> 0, [1,1] -> 1
```

### Регрессия:
```cpp
FFN: y = 2x (простая линейная функция)
Sequential: y = 2x + 1 (линейная функция с смещением)
```

## Критерии успеха тестов

### Функциональные тесты:
- Все методы выполняются без исключений
- Корректные размеры входов/выходов
- Правильный подсчет параметров
- Корректное переключение режимов обучения

### Тесты обучения:
- Потери изменяются в процессе обучения
- Предсказания изменяются после обучения
- Достигается разумная точность (>50% для случайного угадывания)
- История обучения корректно записывается

### Тесты архитектуры:
- Эквивалентные сети имеют одинаковое количество параметров
- Сложные архитектуры корректно строятся
- Dropout работает по-разному в режимах обучения/вывода

## Запуск тестов

```bash
# Сборка тестов
cd build
make nn_tests

# Запуск всех тестов нейронных сетей
./nn_tests

# Запуск конкретной группы тестов
./nn_tests --gtest_filter="FFNTest.*"
./nn_tests --gtest_filter="SequentialTest.*"
./nn_tests --gtest_filter="FFNvSeqTest.*"

# Подробный вывод
./nn_tests --gtest_filter="*Training*" --verbose
```

## Интеграция с CI/CD

Тесты автоматически запускаются через CTest:
```bash
cd build
ctest -R nn_tests -V
```

## Покрытие кода

Тесты покрывают:
- ✅ 100% публичных методов FFN
- ✅ 100% публичных методов Sequential  
- ✅ Основные сценарии использования
- ✅ Граничные случаи и обработку ошибок
- ✅ Различные конфигурации сетей
- ✅ Интеграцию с оптимизаторами и функциями потерь

## Добавление новых тестов

При добавлении новых функций в FFN или Sequential:

1. Добавьте соответствующие тесты в нужный файл
2. Следуйте существующему стилю именования тестов
3. Используйте подходящие тестовые данные
4. Проверьте как нормальные, так и граничные случаи
5. Обновите этот README при необходимости

## Отладка тестов

Для отладки конкретного теста:
```bash
./nn_tests --gtest_filter="FFNTest.Training" --gtest_break_on_failure
```

Для получения дополнительной информации при сбоях:
```bash
./nn_tests --gtest_filter="SequentialTest.ClassificationTraining" --gtest_output=xml:results.xml
``` 