# SGD Оптимизатор для KotML

## Обзор

Реализован полнофункциональный SGD (Stochastic Gradient Descent) оптимизатор для библиотеки нейронных сетей KotML с поддержкой:

- ✅ Базовый SGD
- ✅ SGD с моментумом
- ✅ Nesterov моментум
- ✅ Weight decay (L2 регуляризация)
- ✅ Динамическое изменение learning rate
- ✅ Валидация параметров
- ✅ Управление состоянием оптимизатора

## Файлы

### Заголовки
- `include/kotml/optim/optimizer.hpp` - Базовый класс для всех оптимизаторов
- `include/kotml/optim/sgd.hpp` - Реализация SGD оптимизатора

### Исходники
- `src/optim/sgd.cpp` - Исходный файл SGD (в основном header-only)

### Примеры
- `examples/sgd_example.cpp` - Демонстрация всех возможностей SGD

### Документация
- `docs/sgd_optimizer.md` - Подробная документация на русском языке

## Быстрый Старт

```cpp
#include "kotml/optim/sgd.hpp"

// Создание модели
nn::Linear layer(784, 10);

// Создание оптимизатора
optim::SGD optimizer(0.01f, 0.9f);  // lr=0.01, momentum=0.9
optimizer.AddParameters(layer);

// Цикл обучения
for (int epoch = 0; epoch < 100; ++epoch) {
    // ... прямой проход и вычисление loss ...
    
    optimizer.ZeroGrad();
    // ... обратный проход ...
    optimizer.Step();
}
```

## Особенности Реализации

### Архитектура
- Наследование от базового класса `Optimizer`
- Поддержка всех типов модулей через интерфейс `Module`
- Эффективное управление памятью с RAII

### Безопасность
- Строгая валидация всех параметров
- Информативные сообщения об ошибках на русском языке
- Проверка consistency для специальных режимов (Nesterov)

### Производительность
- Минимизация копирования данных
- Эффективные тензорные операции
- Ленивая инициализация буферов моментума

## Сборка и Тестирование

```bash
# Сборка
mkdir build && cd build
cmake ..
make sgd_example

# Запуск примера
./examples/sgd_example
```

## Конфигурации SGD

| Тип | Learning Rate | Momentum | Weight Decay | Nesterov |
|-----|---------------|----------|--------------|----------|
| Базовый SGD | 0.01 | 0.0 | 0.0 | false |
| SGD + Momentum | 0.01 | 0.9 | 0.0 | false |
| SGD + Weight Decay | 0.01 | 0.9 | 1e-4 | false |
| Nesterov SGD | 0.01 | 0.9 | 0.0 | true |

## Интеграция с CMake

Оптимизатор автоматически включается в сборку библиотеки `kotml` и доступен через:

```cmake
target_link_libraries(your_target kotml)
```

## Следующие Шаги

- [ ] Добавить gradient clipping
- [ ] Реализовать learning rate schedulers
- [ ] Добавить поддержку sparse градиентов
- [ ] Оптимизация для GPU (будущее)

## Соответствие Стандартам

Реализация следует всем правилам проекта KotML:
- ✅ Современный C++17
- ✅ Google C++ Style Guide
- ✅ Английские имена в коде, русская документация
- ✅ Модульная архитектура
- ✅ Исчерпывающие примеры
- ✅ Строгая валидация параметров 